<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>è¡Œå­—æ•°ç»Ÿè®¡ä¸æ’åºå·¥å…·</title>
    <style>
        body { font-family: "Microsoft YaHei", sans-serif; padding: 20px; background: #f0f2f5; color: #333; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .container { display: flex; gap: 20px; height: 70vh; }
        .box { display: flex; flex-direction: column; flex: 1; min-width: 0; }
        label { margin-bottom: 8px; font-weight: bold; display: flex; justify-content: space-between; }
        textarea, .display-area { 
            flex: 1; padding: 12px; font-size: 15px; line-height: 1.6; 
            border: 1px solid #d9d9d9; border-radius: 6px; background: #fff;
            overflow-y: auto; white-space: pre-wrap; word-break: break-all;
        }
        .count-column { flex: 0 0 80px; text-align: center; background: #fafafa; border-left: none; }
        
        /* æ’åºåˆ—è¡¨æ ·å¼ */
        .sort-container { margin-top: 20px; border: 1px solid #d9d9d9; border-radius: 6px; background: #fff; padding: 15px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border-bottom: 1px solid #eee; padding: 10px; text-align: left; }
        th { background: #f5f5f5; }
        .rank-tag { display: inline-block; padding: 2px 8px; border-radius: 10px; background: #1890ff; color: #fff; font-size: 12px; }
    </style>
</head>
<body>

<div class="header">
    <h2>è¡Œå­—æ•°ç»Ÿè®¡ä¸æ™ºèƒ½æ’åº</h2>
    <div>
        <small>å®æ—¶ç»Ÿè®¡ | è‡ªåŠ¨å¯¹é½ | é•¿åº¦æ’åº</small>
    </div>
</div>

<div class="container">
    <div class="box">
        <label>åŸæ–‡å†…å®¹ (DOC/æ–‡æœ¬)</label>
        <textarea id="input" placeholder="åœ¨æ­¤ç²˜è´´ä½ çš„æ–‡æ¡£å†…å®¹..." oninput="process()"></textarea>
    </div>

    <div class="box" style="flex: 0 0 100px;">
        <label>å¯¹åº”å­—æ•°</label>
        <div id="lineCounts" class="display-area count-column"></div>
    </div>
</div>

<div class="sort-container">
    <label>ğŸ“Š é•¿åº¦æ’è¡Œæ¦œ (ä»å¤§åˆ°å°)</label>
    <table>
        <thead>
            <tr>
                <th width="80">æ’å</th>
                <th width="100">å­—æ•°</th>
                <th>åŸæ–‡è¡Œé¢„è§ˆ</th>
            </tr>
        </thead>
        <tbody id="sortList">
            <tr><td colspan="3" style="text-align:center; color:#999;">ç­‰å¾…è¾“å…¥å†…å®¹...</td></tr>
        </tbody>
    </table>
</div>

<script>
    const input = document.getElementById('input');
    const lineCounts = document.getElementById('lineCounts');
    const sortList = document.getElementById('sortList');

    function process() {
        const text = input.value;
        if (!text.trim()) {
            lineCounts.innerHTML = '';
            sortList.innerHTML = '<tr><td colspan="3" style="text-align:center; color:#999;">ç­‰å¾…è¾“å…¥å†…å®¹...</td></tr>';
            return;
        }

        const lines = text.split('\n');
        
        // 1. å¤„ç†å³ä¾§å®æ—¶å¯¹åº”ç»Ÿè®¡
        let countHtml = '';
        const dataForSort = [];

        lines.forEach((line, index) => {
            const len = line.trim().length;
            countHtml += `<div style="height:1.6em; border-bottom:1px solid #f0f0f0;">${len}</div>`;
            
            // å­˜å…¥æ•°ç»„ç”¨äºæ’åºï¼Œåªå­˜æœ‰å†…å®¹çš„è¡Œ
            if (line.trim().length > 0) {
                dataForSort.push({
                    content: line,
                    length: len,
                    originalIndex: index + 1
                });
            }
        });
        lineCounts.innerHTML = countHtml;

        // 2. å¤„ç†æ’åº
        dataForSort.sort((a, b) => b.length - a.length);

        // 3. æ¸²æŸ“æ’åºè¡¨æ ¼
        let sortHtml = '';
        dataForSort.forEach((item, i) => {
            sortHtml += `
                <tr>
                    <td><span class="rank-tag">${i + 1}</span></td>
                    <td><strong>${item.length} å­—</strong></td>
                    <td style="color:#666; font-size:13px;">${item.content.substring(0, 100)}${item.content.length > 100 ? '...' : ''}</td>
                </tr>
            `;
        });
        sortList.innerHTML = sortHtml || '<tr><td colspan="3" style="text-align:center;">æ— æœ‰æ•ˆå†…å®¹</td></tr>';

        // åŒæ­¥æ»šåŠ¨
        input.onscroll = () => { lineCounts.scrollTop = input.scrollTop; };
    }
</script>

</body>
</html>